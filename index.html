<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>did:pqie DID Method Specification v1.0</title>
    <style>
        :root {
            --w3c-blue: #005A9C;
            --w3c-red: #DA121A;
            --text: #1a1a1a;
            --bg: #fff;
            --border: #ddd;
            --code-bg: #f6f8fa;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: "Georgia", serif;
            color: var(--text);
            background: var(--bg);
            max-width: 900px;
            margin: 0 auto;
            padding: 2rem 1.5rem 4rem;
            line-height: 1.7;
        }

        header {
            border-top: 6px solid var(--w3c-blue);
            padding: 1.5rem 0 1rem;
            margin-bottom: 2rem;
        }

        header h1 {
            font-size: 2rem;
            color: var(--w3c-blue);
            font-family: sans-serif;
            margin-bottom: .4rem;
        }

        .meta {
            font-size: .9rem;
            color: #555;
            font-family: sans-serif;
        }

        .meta span {
            margin-right: 1.5rem;
        }

        .status-badge {
            display: inline-block;
            background: #e8f0fe;
            color: var(--w3c-blue);
            border: 1px solid var(--w3c-blue);
            border-radius: 4px;
            padding: 2px 10px;
            font-size: .85rem;
            font-family: sans-serif;
            margin-bottom: 1rem;
        }

        h2 {
            font-size: 1.4rem;
            color: var(--w3c-blue);
            font-family: sans-serif;
            margin: 2rem 0 .6rem;
            border-bottom: 1px solid var(--border);
            padding-bottom: .3rem;
        }

        h3 {
            font-size: 1.1rem;
            color: #333;
            font-family: sans-serif;
            margin: 1.5rem 0 .4rem;
        }

        h4 {
            font-size: 1rem;
            font-family: sans-serif;
            margin: 1.2rem 0 .3rem;
        }

        p {
            margin-bottom: .8rem;
        }

        a {
            color: var(--w3c-blue);
        }

        ul,
        ol {
            margin: .5rem 0 .8rem 1.5rem;
        }

        li {
            margin-bottom: .3rem;
        }

        code {
            font-family: "SFMono-Regular", Consolas, monospace;
            font-size: .875em;
            background: var(--code-bg);
            border: 1px solid var(--border);
            border-radius: 3px;
            padding: 1px 5px;
        }

        pre {
            background: var(--code-bg);
            border: 1px solid var(--border);
            border-radius: 6px;
            padding: 1rem;
            overflow-x: auto;
            margin: .8rem 0 1rem;
            font-family: "SFMono-Regular", Consolas, monospace;
            font-size: .85rem;
            line-height: 1.5;
        }

        pre code {
            background: none;
            border: none;
            padding: 0;
            font-size: inherit;
        }

        table {
            border-collapse: collapse;
            width: 100%;
            margin: .8rem 0 1rem;
            font-size: .9rem;
        }

        th {
            background: var(--w3c-blue);
            color: #fff;
            padding: .5rem .75rem;
            text-align: left;
            font-family: sans-serif;
        }

        td {
            border: 1px solid var(--border);
            padding: .4rem .75rem;
        }

        tr:nth-child(even) td {
            background: #f9f9f9;
        }

        .toc {
            background: #f0f4fa;
            border: 1px solid #c9d9ef;
            border-radius: 6px;
            padding: 1rem 1.5rem;
            margin-bottom: 2rem;
        }

        .toc h2 {
            border: none;
            margin-top: 0;
            font-size: 1.1rem;
        }

        .toc ol {
            margin-left: 1.2rem;
        }

        .toc li {
            line-height: 1.8;
        }

        .note {
            background: #fffbea;
            border-left: 4px solid #f0c040;
            padding: .6rem 1rem;
            margin: .8rem 0;
            font-size: .92rem;
        }

        footer {
            margin-top: 4rem;
            border-top: 1px solid var(--border);
            padding-top: 1rem;
            font-size: .85rem;
            color: #666;
            font-family: sans-serif;
        }
    </style>
</head>

<body>

    <header>
        <div class="status-badge">Working Draft</div>
        <h1>DID Method Specification: <code>did:pqie</code></h1>
        <div class="meta">
            <span><strong>Version:</strong> 1.0.0</span>
            <span><strong>Published:</strong> 2026-02-26</span>
            <span><strong>Authors:</strong> PQIE Research Group</span>
        </div>
        <div class="meta" style="margin-top:.4rem">
            <span><strong>Website:</strong> <a href="https://pqie.network">https://pqie.network</a></span>
            <span><strong>Registry:</strong> <a href="https://github.com/w3c/did-extensions/pull/667">W3C PR
                    #667</a></span>
        </div>
    </header>

    <section>
        <h2>Abstract</h2>
        <p>
            This document defines the <code>did:pqie</code> DID method — a
            <strong>Post-Quantum Identity Encryption</strong> Decentralized Identifier method.
            It provides quantum-safe digital identity management using
            <strong>Ring-LWE lattice cryptography</strong>, dual-hash identifier generation, and cross-blockchain
            ledger support. It ensures that no part of the DID Document ever travels or rests in plaintext.
        </p>
    </section>

    <nav class="toc">
        <h2>Table of Contents</h2>
        <ol>
            <li><a href="#introduction">Introduction</a></li>
            <li><a href="#terminology">Terminology</a></li>
            <li><a href="#architecture">PQIE Architecture Overview</a></li>
            <li><a href="#method-name">DID Method Name</a></li>
            <li><a href="#identifier">Method-Specific Identifier</a></li>
            <li><a href="#crypto">Cryptographic Elements</a></li>
            <li><a href="#crud">CRUD Operations</a></li>
            <li><a href="#security">Security Considerations</a></li>
            <li><a href="#privacy">Privacy Considerations</a></li>
            <li><a href="#context">JSON-LD Context</a></li>
            <li><a href="#example">Example DID Document</a></li>
            <li><a href="#references">References</a></li>
        </ol>
    </nav>

    <section id="introduction">
        <h2>1. Introduction</h2>
        <p>
            The <code>did:pqie</code> method addresses the need for <strong>post-quantum-safe</strong> digital identity.
            It provides:
        </p>
        <ul>
            <li><strong>Quantum resistance:</strong> Based on Ring-LWE hardness.</li>
            <li><strong>Digital Envelope:</strong> Encrypted-by-default DID Documents.</li>
            <li><strong>Homomorphic Noise Filtering:</strong> Efficient payload management.</li>
            <li><strong>Cross-chain support:</strong> Resolvable across Hyperledger Indy, Ethereum, and Fabric.</li>
            </ol>
    </section>

    <section id="terminology">
        <h2>2. Terminology</h2>
        <table>
            <tr>
                <th>Term</th>
                <th>Definition</th>
            </tr>
            <tr>
                <td><strong>PQIE</strong></td>
                <td>Post-Quantum Identity Encryption — the Ring-LWE based framework</td>
            </tr>
            <tr>
                <td><strong>Ring-LWE</strong></td>
                <td>Ring Learning With Errors — a lattice-based hard problem</td>
            </tr>
            <tr>
                <td><strong>Digital Envelope</strong></td>
                <td>KEM + Symmetric encryption for document protection</td>
            </tr>
        </table>
    </section>

    <section id="architecture">
        <h2>3. PQIE Architecture Overview</h2>
        <ol>
            <li><strong>Ring-LWE Engine:</strong> Polynomial arithmetic and NTT transforms.</li>
            <li><strong>PQIE Encryption Layer:</strong> "Digital Envelope" system (KEM + AES-GCM).</li>
            <li><strong>Homomorphic Noise-Filtering:</strong> $c' = c \pmod{q/4}$ logic.</li>
            <li><strong>Ledger-Agnostic Interface:</strong> Adaptable to any key-value ledger.</li>
        </ol>
    </section>

    <section id="method-name">
        <h2>4. DID Method Name</h2>
        <p>The method name is: <strong><code>pqie</code></strong></p>
        <p>Prefix: <code>did:pqie:</code></p>
    </section>

    <section id="identifier">
        <h2>5. Method-Specific Identifier</h2>
        <h3>5.1 Syntax</h3>
        <pre><code>did:pqie:{primary-hash}:{secondary-hash}:{entropy-suffix}</code></pre>
        <h3>5.2 Generation Algorithm</h3>
        <ol>
            <li><strong>Attribute Lifting:</strong> Attributes mapped to polynomial domain with Gaussian noise.</li>
            <li><strong>Ring-LWE Binding:</strong> $R_{ntt} = A_{ntt} \circ pk_{ntt} \pmod q$.</li>
            <li><strong>Non-linear Activation:</strong> <code>tanh</code> activation for side-channel resistance.</li>
            <li><strong>Dual-Hash:</strong> SHA3-512 and Blake2b-128 prefixes.</li>
        </ol>
    </section>

    <section id="crypto">
        <h2>6. Cryptographic Elements</h2>
        <h3>6.1 PQIE Digital Envelope</h3>
        <p>Shared Secret $SS = KEM(pk)$. Ciphertext $CT = AES-GCM(SS, Doc)$.</p>
        <h3>6.2 Lattice Signature</h3>
        <p>Challenge-response: $z = y + c \cdot s$. Verification: $A \cdot z - c \cdot pk \approx$ commitment.</p>
    </section>

    <section id="crud">
        <h2>7. CRUD Operations</h2>
        <h3>7.1 Read (Resolve)</h3>
        <ol>
            <li><strong>Fetch:</strong> Get ciphertext from IPFS via ledger CID.</li>
            <li><strong>Decapsulate:</strong> Recover $SS$ using subject public key.</li>
            <li><strong>Decrypt:</strong> Reveal JSON-LD Document.</li>
            <li><strong>Verify:</strong> Check lattice signature $sig$ against $doc$.</li>
        </ol>
    </section>

    <section id="security">
        <h2>8. Security Considerations</h2>
        <table>
            <tr>
                <th>Scheme</th>
                <th>n</th>
                <th>Quantum Bit-Security</th>
            </tr>
            <tr>
                <td><strong>PQIE-Enc</strong></td>
                <td>512</td>
                <td>256</td>
            </tr>
        </table>
    </section>

    <section id="privacy">
        <h2>9. Privacy Considerations</h2>
        <p>Minimal PII, Gaussian masking, and selective disclosure support.</p>
    </section>

    <section id="context">
        <h2>10. JSON-LD Context</h2>
        <pre><code>{
  "@context": {
    "pqie": "https://pqie.network/ns/did/v1#",
    "publicKeyLattice": "pqie:publicKeyLattice",
    "latticeParams": "pqie:latticeParams"
  }
}</code></pre>
    </section>

    <section id="example">
        <h2>11. Example DID Document</h2>
        <pre><code>{
  "@context": [
    "https://www.w3.org/ns/did/v1",
    "https://pqie.network/ns/did/v1"
  ],
  "id": "did:pqie:5135e697:8b7ecf94:a3f21bc0",
  "verificationMethod": [{
    "id": "...#key-1",
    "type": "PQIE-RingLWE2024",
    "publicKeyLattice": "AAAA...",
    "latticeParams": { "n": 512, "q": 24593 }
  }],
  "authentication": ["...#key-1"]
}</code></pre>
    </section>

    <footer>
        <strong>did:pqie DID Method Specification v1.0</strong><br />
        PQIE Research Group &mdash; Licensed under
        <a href="https://www.w3.org/Consortium/Legal/copyright-software">W3C Software and Document License</a>
    </footer>

</body>

</html>