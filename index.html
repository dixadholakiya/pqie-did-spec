<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>did:pqie DID Method Specification v1.0</title>
    <style>
        :root {
            --w3c-blue: #005A9C;
            --w3c-red: #DA121A;
            --text: #1a1a1a;
            --bg: #fff;
            --border: #ddd;
            --code-bg: #f6f8fa;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: "Georgia", serif;
            color: var(--text);
            background: var(--bg);
            max-width: 900px;
            margin: 0 auto;
            padding: 2rem 1.5rem 4rem;
            line-height: 1.7;
        }

        header {
            border-top: 6px solid var(--w3c-blue);
            padding: 1.5rem 0 1rem;
            margin-bottom: 2rem;
        }

        header h1 {
            font-size: 2rem;
            color: var(--w3c-blue);
            font-family: sans-serif;
            margin-bottom: .4rem;
        }

        .meta {
            font-size: .9rem;
            color: #555;
            font-family: sans-serif;
        }

        .meta span {
            margin-right: 1.5rem;
        }

        .status-badge {
            display: inline-block;
            background: #e8f0fe;
            color: var(--w3c-blue);
            border: 1px solid var(--w3c-blue);
            border-radius: 4px;
            padding: 2px 10px;
            font-size: .85rem;
            font-family: sans-serif;
            margin-bottom: 1rem;
        }

        h2 {
            font-size: 1.4rem;
            color: var(--w3c-blue);
            font-family: sans-serif;
            margin: 2rem 0 .6rem;
            border-bottom: 1px solid var(--border);
            padding-bottom: .3rem;
        }

        h3 {
            font-size: 1.1rem;
            color: #333;
            font-family: sans-serif;
            margin: 1.5rem 0 .4rem;
        }

        h4 {
            font-size: 1rem;
            font-family: sans-serif;
            margin: 1.2rem 0 .3rem;
        }

        p {
            margin-bottom: .8rem;
        }

        a {
            color: var(--w3c-blue);
        }

        ul,
        ol {
            margin: .5rem 0 .8rem 1.5rem;
        }

        li {
            margin-bottom: .3rem;
        }

        code {
            font-family: "SFMono-Regular", Consolas, monospace;
            font-size: .875em;
            background: var(--code-bg);
            border: 1px solid var(--border);
            border-radius: 3px;
            padding: 1px 5px;
        }

        pre {
            background: var(--code-bg);
            border: 1px solid var(--border);
            border-radius: 6px;
            padding: 1rem;
            overflow-x: auto;
            margin: .8rem 0 1rem;
            font-family: "SFMono-Regular", Consolas, monospace;
            font-size: .85rem;
            line-height: 1.5;
        }

        pre code {
            background: none;
            border: none;
            padding: 0;
            font-size: inherit;
        }

        table {
            border-collapse: collapse;
            width: 100%;
            margin: .8rem 0 1rem;
            font-size: .9rem;
        }

        th {
            background: var(--w3c-blue);
            color: #fff;
            padding: .5rem .75rem;
            text-align: left;
            font-family: sans-serif;
        }

        td {
            border: 1px solid var(--border);
            padding: .4rem .75rem;
        }

        tr:nth-child(even) td {
            background: #f9f9f9;
        }

        .toc {
            background: #f0f4fa;
            border: 1px solid #c9d9ef;
            border-radius: 6px;
            padding: 1rem 1.5rem;
            margin-bottom: 2rem;
        }

        .toc h2 {
            border: none;
            margin-top: 0;
            font-size: 1.1rem;
        }

        .toc ol {
            margin-left: 1.2rem;
        }

        .toc li {
            line-height: 1.8;
        }

        .note {
            background: #fffbea;
            border-left: 4px solid #f0c040;
            padding: .6rem 1rem;
            margin: .8rem 0;
            font-size: .92rem;
        }

        footer {
            margin-top: 4rem;
            border-top: 1px solid var(--border);
            padding-top: 1rem;
            font-size: .85rem;
            color: #666;
            font-family: sans-serif;
        }
    </style>
</head>

<body>

    <header>
        <div class="status-badge">Working Draft</div>
        <h1>DID Method Specification: <code>did:pqie</code></h1>
        <div class="meta">
            <span><strong>Version:</strong> 1.0.0</span>
            <span><strong>Published:</strong> 2026-02-25</span>
            <span><strong>Authors:</strong> PQIE Research Group</span>
        </div>
        <div class="meta" style="margin-top:.4rem">
            <span><strong>Context:</strong> <a
                    href="https://pqie.network/ns/did/v1">https://pqie.network/ns/did/v1</a></span>
            <span><strong>Registry:</strong> <a href="https://github.com/w3c/did-extensions/pull/667">W3C PR
                    #667</a></span>
        </div>
    </header>

    <section>
        <h2>Abstract</h2>
        <p>
            This document defines the <code>did:pqie</code> DID method — a
            <strong>Post-Quantum Identity Encryption</strong> Decentralized Identifier method.
            It provides quantum-safe digital identity management using
            <strong>Ring-LWE lattice cryptography</strong> (Kyber-1024 compatible),
            dual-hash identifier generation (SHA-3-512 + Blake2b), and cross-blockchain
            ledger support. It is designed for national-scale identity systems (e.g.,
            Aadhaar KYC) requiring cryptographic agility against quantum adversaries.
        </p>
        <p>
            Conformance with the
            <a href="https://www.w3.org/TR/did-core/">W3C DID Core Specification</a>
            is the normative baseline for this document.
        </p>
    </section>

    <nav class="toc">
        <h2>Table of Contents</h2>
        <ol>
            <li><a href="#introduction">Introduction</a></li>
            <li><a href="#terminology">Terminology</a></li>
            <li><a href="#method-name">DID Method Name</a></li>
            <li><a href="#identifier">Method-Specific Identifier</a></li>
            <li><a href="#crud">CRUD Operations</a>
                <ol>
                    <li><a href="#create">Create</a></li>
                    <li><a href="#read">Read (Resolve)</a></li>
                    <li><a href="#update">Update</a></li>
                    <li><a href="#deactivate">Deactivate</a></li>
                </ol>
            </li>
            <li><a href="#security">Security Considerations</a></li>
            <li><a href="#privacy">Privacy Considerations</a></li>
            <li><a href="#context">JSON-LD Context</a></li>
            <li><a href="#example">Example DID Document</a></li>
            <li><a href="#references">References</a></li>
        </ol>
    </nav>

    <section id="introduction">
        <h2>1. Introduction</h2>
        <p>
            The <code>did:pqie</code> method addresses the growing need for
            <strong>post-quantum-safe</strong> digital identity infrastructure. As quantum
            computers advance toward breaking RSA and ECDSA, identity systems must migrate
            to lattice-based alternatives. <code>did:pqie</code> provides:
        </p>
        <ul>
            <li><strong>Quantum resistance:</strong> Ring-LWE hardness assumption (equivalent to shortest vector problem
                on ideal lattices)</li>
            <li><strong>Collision resistance:</strong> Dual SHA-3-512 / Blake2b hash identifier generation</li>
            <li><strong>Cross-chain support:</strong> Single DID resolvable across Hyperledger Indy, Ethereum, and
                Fabric</li>
            <li><strong>IPFS-backed DID Documents:</strong> Content-addressed, immutable storage</li>
            <li><strong>W3C VC Data Model 2.0:</strong> Native Verifiable Credentials integration</li>
            <li><strong>Aadhaar KYC compatibility:</strong> Designed for India's national identity infrastructure</li>
        </ul>
    </section>

    <section id="terminology">
        <h2>2. Terminology</h2>
        <table>
            <tr>
                <th>Term</th>
                <th>Definition</th>
            </tr>
            <tr>
                <td><strong>PQIE</strong></td>
                <td>Post-Quantum Identity Encryption — the Ring-LWE based cryptographic framework</td>
            </tr>
            <tr>
                <td><strong>Ring-LWE</strong></td>
                <td>Ring Learning With Errors — a lattice-based cryptographic hard problem</td>
            </tr>
            <tr>
                <td><strong>NTT</strong></td>
                <td>Number Theoretic Transform — O(n log n) polynomial multiplication</td>
            </tr>
            <tr>
                <td><strong>DID Document</strong></td>
                <td>A JSON-LD document containing verification methods and service endpoints</td>
            </tr>
            <tr>
                <td><strong>Lattice signature</strong></td>
                <td>A digital signature based on lattice hardness problems, quantum-resistant</td>
            </tr>
            <tr>
                <td><strong>IPFS</strong></td>
                <td>InterPlanetary File System — content-addressed distributed storage</td>
            </tr>
        </table>
    </section>

    <section id="method-name">
        <h2>3. DID Method Name</h2>
        <p>The method name is: <strong><code>pqie</code></strong></p>
        <p>All DIDs using this method MUST begin with: <code>did:pqie:</code></p>
    </section>

    <section id="identifier">
        <h2>4. Method-Specific Identifier</h2>
        <h3>4.1 Syntax</h3>
        <pre><code>did-pqie       = "did:pqie:" primary-hash ":" secondary-hash ":" entropy-suffix
primary-hash   = 8HEXDIG         ; 8-char SHA-3-512 prefix
secondary-hash = 8HEXDIG         ; 8-char Blake2b-128 prefix
entropy-suffix = 8HEXDIG         ; 8-char cryptographic random nonce

Example: did:pqie:5135e697:8b7ecf94:a3f21bc0</code></pre>

        <h3>4.2 Cryptographic Parameters (Kyber-1024 compatible)</h3>
        <table>
            <tr>
                <th>Parameter</th>
                <th>Value</th>
                <th>Description</th>
            </tr>
            <tr>
                <td><code>n</code></td>
                <td>512</td>
                <td>Polynomial degree</td>
            </tr>
            <tr>
                <td><code>q</code></td>
                <td>24593</td>
                <td>Modulus (NTT-friendly prime)</td>
            </tr>
            <tr>
                <td><code>σ</code></td>
                <td>4.0</td>
                <td>Gaussian noise standard deviation</td>
            </tr>
            <tr>
                <td><code>root</code></td>
                <td>5</td>
                <td>NTT primitive root</td>
            </tr>
            <tr>
                <td>Security</td>
                <td>128-bit PQ</td>
                <td>Post-quantum security level</td>
            </tr>
        </table>

        <h3>4.3 Generation Algorithm</h3>
        <ol>
            <li>Lift citizen attributes to Ring-LWE polynomial domain with Gaussian noise (σ=4.0)</li>
            <li>Generate Ring-LWE key pair <code>(pk, sk)</code></li>
            <li>Compute <code>combined_ntt = user_ntt * pk_ntt (mod q)</code>, apply inverse NTT</li>
            <li>Apply pointwise tanh activation for side-channel resistance</li>
            <li><code>primary_hash = SHA3-512(poly_bytes)[:8]</code></li>
            <li><code>secondary_hash = Blake2b-128(poly_bytes)[:8]</code></li>
            <li><code>entropy_suffix = cryptographic_random(4 bytes)</code></li>
            <li>Return <code>did:pqie:{primary_hash}:{secondary_hash}:{entropy_suffix}</code></li>
        </ol>
    </section>

    <section id="crud">
        <h2>5. CRUD Operations</h2>

        <h3 id="create">5.1 Create</h3>
        <ol>
            <li>Generate identifier using algorithm in §4.3</li>
            <li>Generate Ring-LWE key pair <code>(pk, sk)</code></li>
            <li>Build W3C-conformant DID Document (see §9)</li>
            <li>Upload DID Document to IPFS → obtain CID</li>
            <li>Submit NYM transaction to Hyperledger Indy ledger with DID, verkey, and IPFS CID</li>
            <li>Register in DID Registry with metadata (<code>created_at</code>, <code>versionId: "1"</code>)</li>
        </ol>

        <h3 id="read">5.2 Read (Resolve)</h3>
        <p>A <code>did:pqie</code> DID MUST be resolvable through the following lookup chain (in priority order):</p>
        <ol>
            <li>DID Registry (primary store)</li>
            <li>DID Documents store (VC-enriched documents)</li>
            <li>Citizen registration store (fallback)</li>
        </ol>
        <p>Resolution returns a W3C DID Resolution Result:</p>
        <pre><code>{
  "@context": "https://w3id.org/did-resolution/v1",
  "didDocument": { ... },
  "didResolutionMetadata": { "contentType": "application/did+ld+json" },
  "didDocumentMetadata": { "created": "...", "versionId": "1", "deactivated": false }
}</code></pre>
        <p>Resolution endpoints:</p>
        <pre><code>GET  /api/did/resolve/{did}         → W3C resolution envelope
POST /api/did/resolve               → { "did": "did:pqie:..." } body
GET  /1.0/identifiers/{did}         → Universal Resolver compatible</code></pre>
        <div class="note">
            <strong>Note:</strong> Deactivated DIDs MUST return the last known document with
            <code>didDocumentMetadata.deactivated: true</code>. A <code>notFound</code> error
            MUST NOT be returned for deactivated DIDs.
        </div>

        <h3 id="update">5.3 Update</h3>
        <p><strong>Authorization:</strong> Only the DID subject (authenticated citizen) or a government authority may
            update.</p>
        <table>
            <tr>
                <th>Field</th>
                <th>Effect</th>
            </tr>
            <tr>
                <td><code>service</code></td>
                <td>Add/replace service endpoints by <code>id</code></td>
            </tr>
            <tr>
                <td><code>remove_service_ids</code></td>
                <td>Remove listed service IDs</td>
            </tr>
            <tr>
                <td><code>verificationMethod</code></td>
                <td>Rotate/add verification keys</td>
            </tr>
            <tr>
                <td><code>verifiableCredentials</code></td>
                <td>Embed VC objects (e.g., KYC approval)</td>
            </tr>
            <tr>
                <td><code>custom_fields</code></td>
                <td>Merge arbitrary top-level DID document fields</td>
            </tr>
        </table>
        <p>On update: increments <code>versionId</code>, writes <code>DID_UPDATE</code> transaction to ledger,
            re-uploads to IPFS.</p>

        <h3 id="deactivate">5.4 Deactivate</h3>
        <p><strong>Authorization:</strong> Government authority only.</p>
        <ol>
            <li>Submit <code>DID_DEACTIVATE</code> transaction to ledger</li>
            <li>Update DID status to <code>REVOKED</code> in registry</li>
            <li>Set <code>deactivated: true</code> in DID Document</li>
            <li>All associated Verifiable Credentials are also revoked</li>
        </ol>
    </section>

    <section id="security">
        <h2>6. Security Considerations</h2>

        <h3>6.1 Post-Quantum Security</h3>
        <p>
            The <code>did:pqie</code> method derives its security from the
            <strong>Ring Learning With Errors (Ring-LWE)</strong> problem.
            Security level: <strong>128-bit post-quantum</strong> (equivalent to 256-bit classical).
            Algorithm family: Module-Kyber (NIST PQC Round 4 finalist basis).
        </p>

        <h3>6.2 Identifier Uniqueness</h3>
        <p>
            Dual hashing (SHA-3-512 + Blake2b-128) with a random entropy suffix ensures:
            Birthday bound ≥ 2<sup>256</sup> operations against collision,
            plus 2<sup>32</sup> additional entropy factor per identifier.
        </p>

        <h3>6.3 Threat Model</h3>
        <table>
            <tr>
                <th>Threat</th>
                <th>Mitigation</th>
            </tr>
            <tr>
                <td>Quantum computer breaks ECDSA</td>
                <td>Ring-LWE keys are quantum-resistant</td>
            </tr>
            <tr>
                <td>Replay attack</td>
                <td>Anti-replay nonce in identity tokens</td>
            </tr>
            <tr>
                <td>DID Document tampering</td>
                <td>IPFS CID integrity verification</td>
            </tr>
            <tr>
                <td>Unauthorized update</td>
                <td>Session authentication + authority check</td>
            </tr>
            <tr>
                <td>Rate abuse</td>
                <td>5 tokens/hour/user rate limiting</td>
            </tr>
        </table>
    </section>

    <section id="privacy">
        <h2>7. Privacy Considerations</h2>
        <ul>
            <li><strong>Minimal PII:</strong> DID Documents MUST NOT contain raw Aadhaar numbers or biometric data</li>
            <li><strong>Gaussian masking:</strong> Attributes are lifted to polynomial domain with σ=4.0 noise —
                computationally indistinguishable from source data</li>
            <li><strong>Selective disclosure:</strong> W3C VC selective disclosure supported natively</li>
            <li><strong>Right to erasure:</strong> Deactivation marks DID inactive; compliant verifiers MUST reject
                deactivated DIDs</li>
        </ul>
    </section>

    <section id="context">
        <h2>8. JSON-LD Context</h2>
        <p>Context URL: <a
                href="https://dixadholakiya.github.io/pqie-did-spec/context.jsonld">https://dixadholakiya.github.io/pqie-did-spec/context.jsonld</a>
        </p>
        <pre><code>{
  "@context": {
    "@version": 1.1,
    "@protected": true,
    "pqie": "https://dixadholakiya.github.io/pqie-did-spec/#",
    "PQIE-LatticeSignature2024": { "@id": "pqie:LatticeSignature2024", "@type": "@id" },
    "PQIE-RingLWE2024":          { "@id": "pqie:RingLWE2024",          "@type": "@id" },
    "RingLWESignature2024":      { "@id": "pqie:RingLWESignature2024",  "@type": "@id" },
    "AadhaarKYCCredential":      { "@id": "pqie:AadhaarKYCCredential",  "@type": "@id" },
    "publicKeyLattice":          { "@id": "pqie:publicKeyLattice",      "@type": "xsd:string" },
    "latticeParams":             { "@id": "pqie:latticeParams",         "@type": "@json" }
  }
}</code></pre>
    </section>

    <section id="example">
        <h2>9. Example DID Document</h2>
        <pre><code>{
  "@context": [
    "https://www.w3.org/ns/did/v1",
    "https://dixadholakiya.github.io/pqie-did-spec/context.jsonld"
  ],
  "id": "did:pqie:5135e697:8b7ecf94:a3f21bc0",
  "verificationMethod": [{
    "id": "did:pqie:5135e697:8b7ecf94:a3f21bc0#key-1",
    "type": "PQIE-RingLWE2024",
    "controller": "did:pqie:5135e697:8b7ecf94:a3f21bc0",
    "publicKeyLattice": "AAAA...base64encodedpolynomialkey...",
    "latticeParams": { "n": 512, "q": 24593, "algorithm": "Ring-LWE-Kyber1024" }
  }],
  "authentication": ["did:pqie:5135e697:8b7ecf94:a3f21bc0#key-1"],
  "assertionMethod": ["did:pqie:5135e697:8b7ecf94:a3f21bc0#key-1"],
  "service": [{
    "id": "did:pqie:5135e697:8b7ecf94:a3f21bc0#aadhaar-kyc",
    "type": "AadhaarKYCService",
    "serviceEndpoint": "https://aadhaar-kyc.gov.in/verify"
  }],
  "created": "2026-02-25T00:10:00Z",
  "updated": "2026-02-25T00:15:00Z"
}</code></pre>
    </section>

    <section id="references">
        <h2>10. References</h2>
        <ul>
            <li><a href="https://www.w3.org/TR/did-core/">W3C DID Core Specification</a> — normative</li>
            <li><a href="https://github.com/w3c/did-extensions">W3C DID Method Registry (did-extensions)</a></li>
            <li><a href="https://www.w3.org/TR/vc-data-model-2.0/">W3C Verifiable Credentials Data Model 2.0</a></li>
            <li><a href="https://csrc.nist.gov/projects/post-quantum-cryptography">NIST Post-Quantum Cryptography
                    Standards</a></li>
            <li><a href="https://pq-crystals.org/kyber/">CRYSTALS-Kyber (Module-Kyber)</a></li>
            <li><a href="https://w3c-ccg.github.io/did-resolution/">DID Resolution Specification</a></li>
            <li><a href="https://github.com/decentralized-identity/universal-resolver">Universal Resolver</a></li>
            <li><a href="https://hyperledger-indy.readthedocs.io/">Hyperledger Indy</a></li>
        </ul>
    </section>

    <footer>
        <strong>did:pqie DID Method Specification v1.0</strong><br />
        PQIE Research Group &mdash; Licensed under
        <a href="https://www.w3.org/Consortium/Legal/copyright-software">W3C Software and Document License</a><br />
        <a href="https://github.com/w3c/did-extensions/pull/667">W3C Registry PR #667</a>
    </footer>

</body>

</html>